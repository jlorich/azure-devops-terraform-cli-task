jobs:
# Validates a valid template
- job: Authenticate
  displayName: Test Authetication
  dependsOn:
  pool:
    vmImage: 'Ubuntu-16.04'

  steps:
  - task: terraform@0
    inputs:
      command: 'CLI'
      providerAzureConnectedServiceName: 'MTC Denver Sandbox'
      backendAzureProviderStorageAccountName: 'mtcdenterraformsandbox'
      backendAzureContainerName: 'tfstate'
      backendAzureStateFileKey: 'terraform.tfstate'
      script: |
        # Validate
        terraform validate

        # Plan
        terraform plan -input=false -out=testplan.tf
        
    displayName: Run Terraform CLI

